---
layout: post
title: "微信hook"
description: ""
date: 2020-02-02
tags: [learn,project,hook,note]
comments: true
share: true
---

**对HOOK有一个更深的认识**

![](https://gitee.com/hkslover/blog_img/raw/master/2020/QQ%E6%88%AA%E5%9B%BE20200202170652.png)

![](https://gitee.com/hkslover/blog_img/raw/master/2020/QQ%E6%88%AA%E5%9B%BE20200202170730.png)

![](https://gitee.com/hkslover/blog_img/raw/master/2020/QQ%E6%88%AA%E5%9B%BE20200202191417.png)

**具体的hook流程也已经明确**

对hook目标地址更改

```asm
jmp 申请的新地址
```

**新地址**
```asm
先执行hook目标地址的原代码
mov 地址,寄存器
pushad
call 我的子程序
popad
jmp hook目标地址的下一句
```

**另外在内联汇编中，jmp和call后面跟着的是相对地址，需要计算，具体公式为:**

**相对地址（也就是call和jmp后面跟着的地址） = 被跳转地址（被jmp和被call的地址） - 当前地址（要执行jmp和call命令的地址） - 5（jmp和call占用的字节）
