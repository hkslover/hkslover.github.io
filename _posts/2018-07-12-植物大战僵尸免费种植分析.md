---
published: true
---

**首先先找到当前阳光的地址**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/nTxaYMwUYcDOvHN7df0Y7DklNIPYI1M*ZvUlZBJ7y9Y!/b/dDIBAAAAAAAA&bo=BAPRAAAAAAADB*Q!&rf=viewer_4)

**然后扫描什么访问了当前地址，种植豌豆射手，多出两个数据**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/zR3x5VhsNvel8SkLcn42acSLTCDAb8HODrB68AU2lC8!/b/dAgBAAAAAAAA&bo=YwLCAAAAAAADF5E!&rf=viewer_4)

**分析这其中一个数据**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/LwAoHZrjbA300tgXJCVmEeEX1y.WSIaUFeP2OGS5Zqw!/b/dDABAAAAAAAA&bo=KgLRAQAAAAADF8o!&rf=viewer_4)

**OD跟一下，并注释**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/3uVRPrqVT69ANgpBLGAtsv2A1ClHJr3GBztcUNW78R0!/b/dIMAAAAAAAAA&bo=vQKAAAAAAAADFw0!&rf=viewer_4)

**在这段代码的CALL头下个断**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/WoI2IzEozyKb2VXR5HFqtiHtXaIXY0tZO2VEzPbQCYo!/b/dDEBAAAAAAAA&bo=0wJmAAAAAAADF4U!&rf=viewer_4)

**然后回到游戏种植豌豆射手，程序断了下来，回到OD，发现寄存器EAX编程64，转为十进制也就是100，刚好是豌豆射手的价格，只要弄清这个EAX的64是怎样来的，然后修改这个值，就可以达到免费种植植物**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/u1q7UiJSxDJpovr5FBGpbHBuU.5pVElR5xFKrIb*93U!/b/dC0BAAAAAAAA&bo=VQGaAAAAAAADF*w!&rf=viewer_4)

**跟随反汇编窗口**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/t.2r*xu*HCTMRNn3u4HVDbUv3ps0peWVRt7kpXxj52g!/b/dDABAAAAAAAA&bo=ugQnAQAAAAADF6o!&rf=viewer_4)

**然后在这里下断，发现在种植植物后，EAX的值为64，也就是说，在这个断之前就已经定义好豌豆射手的价格，并将它放在了一个常亮，经过代码把这个值放到了EAX，猜测在CALL 4EDAE0将值赚到了EAX，于是在这个CALL前下个断，种植豌豆射手，发现EAX为0，由此断定，EAX的值实在CALL 4EDAE8中传过来的。**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/Bl0M*ItfAYryGluxi18lM4u1R75nG8hOpfa3SfREQvA!/b/dAgBAAAAAAAA&bo=DAKlAAAAAAADF5k!&rf=viewer_4)

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/BA408.VsLMUeO*wL5cpZB9Qm*18I0lVORvPb027f7b4!/b/dGEBAAAAAAAA&bo=EATKAAAAAAADF.w!&rf=viewer_4)

**跟进CALL，单步执行过这个CALL时，EAX变成了100，那么我们跟进这个CALL，并注释**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/wCaT1oZgS2H9sOLPs3vBvUiySJRS*UryDkyevsjf0VM!/b/dDIBAAAAAAAA&bo=qANrAAAAAAADF*I!&rf=viewer_4)

**单步执行过这里时，EAX变成了100，由此可以断定，这句代码为关键代码处，注释。**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/TruKy8OlQ1vs80t.P3rxtOkRK7bj8jdYSaOcm4ubA38!/b/dC8BAAAAAAAA&bo=4gPTAAAAAAADFwA!&rf=viewer_4)

**这句关键代码处，意思是将EAX*4然后加上69F2C0这个地址的值，执行这句代码之前，EAX为0，0*4还等于0，加上69F2C0等于64，由此我猜测69F2C0地址的值为64，十进制也就等于100**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/ns0qU2gbrPGi14uyX*gdRiHd60Zq7InTFIkoD.xCdXo!/b/dFkAAAAAAAAA&bo=vgDHAAAAAAADF0s!&rf=viewer_4)

**不出所料，正是100。修改一下**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/wB7r1lVCmTKnxn.jaixoRCROWWZMcfMgVYeHbgyvuxk!/b/dDIBAAAAAAAA&bo=qgSdAgAAAAADR1M!&rf=viewer_4)

**用了同样的办法找了下向日葵的**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/mjZ4dLRQXlJHHauvS9k2vakh8iaWME7AVMwI.ygfY78!/b/dEMBAAAAAAAA&bo=7QPLAAAAAAADBwc!&rf=viewer_4)

**发现在执行关键代码的上一句时，EAX的值为9，然后EAX*4加上69F2C0，9*4等于36，转化为十进制为24，猜测69F2C0加上24就应该等于50**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/9uxrS0r1YQGcAjYax4rkEd1ZMUUdVvXYS2ZIQMYOJMo!/b/dDMBAAAAAAAA&bo=NgFcAQAAAAADF1g!&rf=viewer_4)

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/WMvRnuGkqQvL.VfO69uEfEopeBAx5n0MCTQYHEVqHH0!/b/dFcAAAAAAAAA&bo=IgFJAQAAAAADF1k!&rf=viewer_4)

**由上述分析，可得樱桃炸弹的价格**

![1](http://m.qpic.cn/psb?/V14Vds0B2XMINS/zVB6dIVSverNrGBcKD7JjAVoiz9DDeqLwUpYOhhlloc!/b/dFYAAAAAAAAA&bo=LwE5AQAAAAADFyQ!&rf=viewer_4)

---

总结：经过这次分析，学到了不少，在分析过程中应该时刻留意CALL的返回，并逻辑判断是否在这个CALL执行了什么样的程序。


