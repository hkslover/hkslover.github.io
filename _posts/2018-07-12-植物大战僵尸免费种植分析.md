---
published: true
---

**首先先找到当前阳光的地址**

![1](https://camo.githubusercontent.com/d2c18f8ecf804e6b41e0ce342cde726f521d6006/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f6e547861594d77555963444f76484e376466305937446b6c4e49505949314d2a5a76556c5a424a37793959212f622f64444942414141414141414126626f3d424150524141414141414144422a51212672663d7669657765725f34)

**然后扫描什么访问了当前地址，种植豌豆射手，多出两个数据**

![1](https://camo.githubusercontent.com/0a09a33f9d9528a0a7a4c21c15720979581d63cd/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f7a523378355668734e76656c38536b4c636e34326163534c544344416238484f44724236384155326c4338212f622f64416742414141414141414126626f3d59774c434141414141414144463545212672663d7669657765725f34)

**分析这其中一个数据**

![1](https://camo.githubusercontent.com/1a59d88e8c73bac2308e005f385f79adfb82dc91/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f4c77416f485a726a62413330307467584a43566d4565455831792e5753496155466550324f4753355a7177212f622f64444142414141414141414126626f3d4b674c52415141414141414446386f212672663d7669657765725f34)

**OD跟一下，并注释**

![1](https://camo.githubusercontent.com/c8faa06284cb7a02cfdbe17979033fcf5b02fd75/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f3375565250727156543639414e6770424c4741747376324131436c484a723347427a7463554e5737385230212f622f64494d41414141414141414126626f3d76514b414141414141414144467730212672663d7669657765725f34)

**在这段代码的CALL头下个断**

![1](https://camo.githubusercontent.com/cb0de8db642b9fc0e5219a1a1fec540683895dbc/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f576f4932497a456f7a794b62325658523548467174694874586149585930745a4f3256457a50625143596f212f622f64444542414141414141414126626f3d30774a6d4141414141414144463455212672663d7669657765725f34)

**然后回到游戏种植豌豆射手，程序断了下来，回到OD，发现寄存器EAX编程64，转为十进制也就是100，刚好是豌豆射手的价格，只要弄清这个EAX的64是怎样来的，然后修改这个值，就可以达到免费种植植物**

![1](https://camo.githubusercontent.com/c763fb7784ec074e9fc43dafb201d366dbb32fa3/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f7531713755694a5378444a706f7672354642477062484275552e357056456c523578464b7249622a393355212f622f64433042414141414141414126626f3d565147614141414141414144462a77212672663d7669657765725f34)

**跟随反汇编窗口**

![1](https://camo.githubusercontent.com/82c816abe930ed3edf8f4d9c314732e84fcd0a47/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f742e32722a78752a4843544d524e6e33753448564462557633707330706557565274376b7058786a353267212f622f64444142414141414141414126626f3d7567516e415141414141414446366f212672663d7669657765725f34)

**然后在这里下断，发现在种植植物后，EAX的值为64，也就是说，在这个断之前就已经定义好豌豆射手的价格，并将它放在了一个常亮，经过代码把这个值放到了EAX，猜测在CALL 4EDAE0将值转到了EAX，于是在这个CALL前下个断，种植豌豆射手，发现EAX为0，由此断定，EAX的值实在CALL 4EDAE8中传过来的。**

![1](https://camo.githubusercontent.com/5277a381bc23e752657252f84d854340c8deb7df/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f426c304d2a49746641597279476c75786931386c4d3475315237356e4738684f7066613353665245517641212f622f64416742414141414141414126626f3d44414b6c414141414141414446356b212672663d7669657765725f34)

![1](https://camo.githubusercontent.com/0b1b1f7964fa3c9b3c7eb29c1c50c53ce867dff8/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f42413430382e56734c4d55654f2a774c3563705a4239516d2a313849306c564f5276506230323766376234212f622f64474542414141414141414126626f3d4541544b4141414141414144462e77212672663d7669657765725f34)

**跟进CALL，单步执行过这个CALL时，EAX变成了100，那么我们跟进这个CALL，并注释**

![1](https://camo.githubusercontent.com/18dd318806c782a44aef9c18371b8461c35977db/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f77436154316f5a6753324839734f4c507333764276556979534a52532a557279446b796576736a6630564d212f622f64444942414141414141414126626f3d71414e724141414141414144462a49212672663d7669657765725f34)

**单步执行过这里时，EAX变成了100，由此可以断定，这句代码为关键代码处，注释。**

![1](https://camo.githubusercontent.com/4e3bab59fa253d1aa1b655f498ae919892917468/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f5472754b79384f6c513176733830742e50337278744f6b524b37626a386a645953614f636d347562413338212f622f64433842414141414141414126626f3d346750544141414141414144467741212672663d7669657765725f34)

**这句关键代码处，意思是将EAX*4然后加上69F2C0这个地址的值，执行这句代码之前，EAX为0，0乘4等于0，加上69F2C0等于64，由此我猜测69F2C0地址的值为64，十进制也就等于100**

![1](https://camo.githubusercontent.com/3b20bd0aff65119c3d60e803a156a7bbecafd4e1/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f6e733071553267627250476931347579582a67645269486436305a7137496e5446496b6f442e784364586f212f622f64466b41414141414141414126626f3d766744484141414141414144463073212672663d7669657765725f34)

**不出所料，正是100。修改一下**

![1](https://camo.githubusercontent.com/1be8102d7a5f1b1ab47d04d1642b0fdfafd07865/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f77423772316c56436d544b6e786e2e6a6169786f5243524f57575a4d63664d67565965486267797675786b212f622f64444942414141414141414126626f3d71675364416741414141414452314d212672663d7669657765725f34)

**用了同样的办法找了下向日葵的**

![1](https://camo.githubusercontent.com/8f9db6f398fff02d95ec9cd4c86272515ef788e8/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f6d6a5a34644c5251586c4a484861757653396b3276616b68386961574d453741564d77492e796766593738212f622f64454d42414141414141414126626f3d3751504c4141414141414144427763212672663d7669657765725f34)

**发现在执行关键代码的上一句时，EAX的值为9，然后EAX乘4加上69F2C0，9乘4等于36，转化为十进制为24，猜测69F2C0加上24就应该等于50**

![1](https://camo.githubusercontent.com/8065e9329ae15f9d25d27c442e7661465a7ebc48/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f397578725330723159514763416a59617834726b4564315a4d5555645676585953325a49514d594f4a4d6f212f622f64444d42414141414141414126626f3d4e6746634151414141414144463167212672663d7669657765725f34)

![1](https://camo.githubusercontent.com/b20e02dae0ca923b3917640c9fb1a8e600f68b08/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f574d76526e75476b7151764c2e56664f3639754566456f7065424178356e304d4354515948455671484830212f622f64466341414141414141414126626f3d4967464a415141414141414446316b212672663d7669657765725f34)

**由上述分析，可得樱桃炸弹的价格**

![1](https://camo.githubusercontent.com/62f8cf6dac1a927c572b6e728fe05b07b803b317/687474703a2f2f6d2e717069632e636e2f7073623f2f563134566473304232584d494e532f7a564236644956537665724e724742634b44374a6a41566f697a39444465714c775570594f68686c6c6f63212f622f64465941414141414141414126626f3d4c7745354151414141414144467951212672663d7669657765725f34)

---

总结：经过这次分析，学到了不少，在分析过程中应该时刻留意CALL的返回，并逻辑判断是否在这个CALL执行了什么样的程序。


