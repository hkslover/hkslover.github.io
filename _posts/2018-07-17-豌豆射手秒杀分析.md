---
published: true
---

**之前分析过植物免费0阳光种植，得出的结论是：这个植物的价格是在种植之前就已经存放在一定基址里了，然后通过MOV命令传到寄存器中，也就是说，找到这种常量的标志，就是在关键代码上面出现了一个地址，那么尝试用CE添加下这个地址，会有意想不到的收获**

**以前用过间接HOOK实现过僵尸秒杀，不过只能秒杀普通僵尸，其他类型的僵尸不能达到目的，于是今天又来搞植物大战僵尸了。我要找到存放豌豆射手威力的基址**

---

**首先找到屏幕上当前僵尸血量的地址，然后找出访问**

![1](http://images.cnblogs.com/cnblogs_com/slover/1202587/o_QQ%e6%8b%bc%e9%9f%b3%e6%88%aa%e5%9b%be20180717182512.png)

**然后OD挨个跟一下，看了一下然后锁定到了1319这个地址，然后下断，发现某个寄存器里已经出现10进制为20的十六进制值，而且豌豆射手的威力也刚好为20，然后就用到分析0种植那里积累的经验，一个寄存器一个寄存器网上找，一个CALL一个CALL分析，分析过程就是在可疑的代码处下断，然后看关键寄存器是否出现20，如果出现，则20在断下的这局代码之前就已经被放在寄存器里了，于是再接着往上下断，直到下断后关键寄存器不是20，那么把20放到关键寄存器的汇编代码就在下断的下方，且在附近，以此类推，就能找到最先的基址。**

**不过这次分析很可惜，没有截图，会技术了就行了**

